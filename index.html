async function fetchText(url) {
  const res = await fetch(url);
  if (!res.ok) throw new Error(`Network response was not ok: ${res.status}`);
  return await res.text();
}

async function loadData() {
  const status = document.getElementById('status');
  const error = document.getElementById('error');
  const m3uPreview = document.getElementById('m3uPreview');
  const epgPreview = document.getElementById('epgPreview');

  try {
    status.textContent = 'Fetching M3U playlist...';
    const m3uText = await fetchText('https://raw.githubusercontent.com/iptv-org/iptv/master/streams/uk.m3u');
    m3uPreview.textContent = m3uText.slice(0, 1000) + (m3uText.length > 1000 ? '\n... (truncated)' : '');

    status.textContent = 'Fetching EPG XML...';
    const epgText = await fetchText('https://raw.githubusercontent.com/iptv-org/epg/master/guides/gb/freeview.xml'); // try freeview.xml or another
    epgPreview.textContent = epgText.slice(0, 1000) + (epgText.length > 1000 ? '\n... (truncated)' : '');

    status.textContent = 'Data loaded successfully!';
  } catch (err) {
    error.textContent = 'Error loading data: ' + err.message;
    status.textContent = '';
  }
}
