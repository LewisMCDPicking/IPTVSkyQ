<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Freeview IPTV + EPG Demo</title>
<style>
  body { font-family: Arial, sans-serif; background: #222; color: #eee; padding: 20px; }
  pre { background: #111; padding: 10px; max-height: 200px; overflow: auto; }
  #status { margin-bottom: 10px; }
  #error { color: #f66; margin-bottom: 10px; }
</style>
</head>
<body>

<h1>Freeview IPTV + EPG Demo</h1>
<div id="status">Loading...</div>
<div id="error"></div>

<h2>M3U Playlist Preview:</h2>
<pre id="m3uPreview">Loading M3U...</pre>

<h2>EPG XML Preview:</h2>
<pre id="epgPreview">Loading EPG...</pre>

<script>
async function fetchText(url) {
  const res = await fetch(url);
  if (!res.ok) throw new Error(`Network response was not ok: ${res.status}`);
  return await res.text();
}

async function loadData() {
  const status = document.getElementById('status');
  const error = document.getElementById('error');
  const m3uPreview = document.getElementById('m3uPreview');
  const epgPreview = document.getElementById('epgPreview');

  const m3uUrl = 'https://raw.githubusercontent.com/iptv-org/iptv/master/streams/uk.m3u';
  const epgUrl = 'https://raw.githubusercontent.com/iptv-org/epg/master/guides/gb/freeview.xml';

  try {
    status.textContent = 'Fetching M3U playlist...';
    const m3uText = await fetchText(m3uUrl);
    m3uPreview.textContent = m3uText.slice(0, 1000) + (m3uText.length > 1000 ? '\n... (truncated)' : '');

    status.textContent = 'Fetching EPG XML...';
    const epgText = await fetchText(epgUrl);
    epgPreview.textContent = epgText.slice(0, 1000) + (epgText.length > 1000 ? '\n... (truncated)' : '');

    status.textContent = 'Data loaded successfully!';
    error.textContent = '';
  } catch (err) {
    error.textContent = 'Error loading data: ' + err.message;
    status.textContent = '';
    m3uPreview.textContent = '';
    epgPreview.textContent = '';
  }
}

loadData();
</script>

</body>
</html>
